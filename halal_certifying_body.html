<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HDIP - Halal Certification System</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-green: #0d8c4c;
            --secondary-green: #16a765;
            --light-green: #e7f9ef;
            --bs-body-bg: #f5f7fa;
            --bs-font-sans-serif: 'Inter', sans-serif;
        }

        body {
            background-color: var(--bs-body-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Branding */
        .bg-brand { background: linear-gradient(135deg, var(--primary-green), #0a6d3a); }
        .text-brand { color: var(--primary-green) !important; }
        .border-brand { border-color: var(--primary-green) !important; }
        
        .btn-brand {
            background: var(--primary-green);
            color: white;
            border: none;
            box-shadow: 0 4px 6px rgba(13, 140, 76, 0.2);
        }
        .btn-brand:hover {
            background: #0a6d3a;
            color: white;
            transform: translateY(-1px);
        }

        /* Stats Cards */
        .stat-card {
            border: none;
            border-left: 5px solid var(--primary-green);
            transition: transform 0.2s;
        }
        .stat-card:hover { transform: translateY(-3px); }
        
        /* View Management */
        .view-section { display: none; animation: fadeIn 0.3s ease-in-out; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Custom Table formatting */
        .table-input { min-width: 200px; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-brand shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="#" onclick="navigateToPage('home')">
                <i class="bi bi-shield-check fs-4"></i> HDIP Certification
            </a>
            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto gap-lg-3">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="navigateToPage('home')" id="nav-home">
                            <i class="bi bi-speedometer2 me-1"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="navigateToPage('inspection')" id="nav-inspection">
                            <i class="bi bi-clipboard-check me-1"></i> Document Review
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container py-4 flex-grow-1">

        <div id="home-page" class="view-section active">
            <div class="card border-0 shadow-sm bg-brand text-white mb-4 overflow-hidden rounded-4">
                <div class="card-body p-4 p-md-5 text-center position-relative">
                    <div class="position-absolute top-0 start-0 w-100 h-100" style="background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0) 70%);"></div>
                    <h1 class="display-6 fw-bold mb-2 position-relative">HDIP Certification System</h1>
                    <p class="lead mb-4 opacity-75 position-relative">Halal Development Institute of the Philippines</p>
                    <button class="btn btn-light text-success fw-bold px-4 py-2 rounded-pill position-relative" onclick="navigateToPage('inspection')">
                        <i class="bi bi-plus-circle-fill me-2"></i> Start New Review
                    </button>
                </div>
            </div>

            <div class="row g-3 mb-4">
                <div class="col-sm-6 col-lg-3">
                    <div class="card shadow-sm stat-card h-100">
                        <div class="card-body text-center p-3">
                            <h2 class="display-5 fw-bold text-brand mb-0">47</h2>
                            <small class="text-muted text-uppercase fw-bold">Total Apps</small>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-3">
                    <div class="card shadow-sm stat-card h-100" style="border-left-color: #ffc107;">
                        <div class="card-body text-center p-3">
                            <h2 class="display-5 fw-bold text-warning mb-0">12</h2>
                            <small class="text-muted text-uppercase fw-bold">Pending</small>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-3">
                    <div class="card shadow-sm stat-card h-100" style="border-left-color: #198754;">
                        <div class="card-body text-center p-3">
                            <h2 class="display-5 fw-bold text-success mb-0">28</h2>
                            <small class="text-muted text-uppercase fw-bold">Approved</small>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6 col-lg-3">
                    <div class="card shadow-sm stat-card h-100" style="border-left-color: #dc3545;">
                        <div class="card-body text-center p-3">
                            <h2 class="display-5 fw-bold text-danger mb-0">7</h2>
                            <small class="text-muted text-uppercase fw-bold">Rejected</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card border-0 shadow-sm rounded-4">
                <div class="card-header bg-white border-bottom-0 pt-4 px-4">
                    <h5 class="fw-bold mb-0"><i class="bi bi-clock-history text-brand me-2"></i>Recent Applications</h5>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead class="bg-light text-secondary small text-uppercase">
                                <tr>
                                    <th class="ps-4">Application ID</th>
                                    <th>Company Name</th>
                                    <th>Date Submitted</th>
                                    <th>Status</th>
                                    <th class="pe-4 text-end">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="ps-4 fw-bold text-secondary">#APP-2025-001</td>
                                    <td>Mr. Food Station</td>
                                    <td>2025-01-15</td>
                                    <td><span class="badge bg-warning text-dark bg-opacity-25 border border-warning">Pending</span></td>
                                    <td class="pe-4 text-end">
                                        <button class="btn btn-sm btn-brand rounded-pill px-3" onclick="loadCompanyData('mrfood')">Review</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="ps-4 fw-bold text-secondary">#APP-2025-002</td>
                                    <td>Cafe De Armando</td>
                                    <td>2025-01-14</td>
                                    <td><span class="badge bg-info text-dark bg-opacity-25 border border-info">Reviewing</span></td>
                                    <td class="pe-4 text-end">
                                        <button class="btn btn-sm btn-brand rounded-pill px-3" onclick="loadCompanyData('armando')">Review</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="inspection-page" class="view-section">
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="d-flex flex-column gap-4 sticky-lg-top" style="top: 90px; z-index: 1;">
                        
                        <div class="card border-0 shadow-sm rounded-4">
                            <div class="card-header bg-brand text-white py-3 rounded-top-4">
                                <h5 class="mb-0 fw-bold"><i class="bi bi-building me-2"></i>Details</h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <label class="form-label small fw-bold text-muted">COMPANY</label>
                                    <input type="text" class="form-control" id="companyName" placeholder="Company Name">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label small fw-bold text-muted">CONTACT PERSON</label>
                                    <input type="text" class="form-control" id="contactPerson" placeholder="Full Name">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label small fw-bold text-muted">ADDRESS</label>
                                    <input type="text" class="form-control" id="address" placeholder="Business Address">
                                </div>
                                <div class="row g-2 mb-3">
                                    <div class="col-6">
                                        <label class="form-label small fw-bold text-muted">CONTACT NO.</label>
                                        <input type="tel" class="form-control" id="contactNo" placeholder="0912...">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label small fw-bold text-muted">DATE</label>
                                        <input type="date" class="form-control" id="auditDate">
                                    </div>
                                </div>
                                <div class="mb-0">
                                    <label class="form-label small fw-bold text-muted">CERTIFIER NAME</label>
                                    <input type="text" class="form-control" id="auditorName">
                                </div>
                            </div>
                        </div>

                        <div class="card border-0 shadow-sm rounded-4 bg-light">
                            <div class="card-body p-4">
                                <h6 class="fw-bold text-brand mb-3">Inspection Summary</h6>
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="text-muted small">Total Documents</span>
                                    <span class="fw-bold" id="totalCount">0/15</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="text-muted small">Compliant</span>
                                    <span class="fw-bold text-success" id="conformCount">0</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="text-muted small">Non-Compliant</span>
                                    <span class="fw-bold text-danger" id="nonconformCount">0</span>
                                </div>
                                <hr class="opacity-25">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-brand" onclick="submitInspection()">
                                        <i class="bi bi-send-fill me-2"></i> Submit Review
                                    </button>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-success w-100 btn-sm" onclick="markAllConforms()">Mark All OK</button>
                                        <button class="btn btn-outline-secondary w-100 btn-sm" onclick="clearAllStatus()">Reset</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-8">
                    <div class="card border-0 shadow-sm rounded-4 mb-4">
                        <div class="card-header bg-white border-bottom pt-4 px-4 pb-3">
                            <h5 class="fw-bold mb-0"><i class="bi bi-list-check text-brand me-2"></i>Document Checklist</h5>
                        </div>
                        <div class="card-body p-0 table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="bg-light text-secondary small text-uppercase">
                                    <tr>
                                        <th class="ps-4" style="width: 5%">#</th>
                                        <th style="width: 35%">Document</th>
                                        <th style="width: 30%">Conformity</th>
                                        <th class="pe-4" style="width: 30%">Remarks</th>
                                    </tr>
                                </thead>
                                <tbody id="checklistBody">
                                    </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card border-0 shadow-sm rounded-4">
                        <div class="card-body p-4">
                            <h6 class="fw-bold text-brand mb-3"><i class="bi bi-pencil-square me-2"></i>Certifier Notes & Findings</h6>
                            <textarea class="form-control" id="auditorNotes" rows="4" placeholder="Add additional observations..."></textarea>
                            <div class="mt-3 d-flex gap-2">
                                <button class="btn btn-sm btn-outline-primary" onclick="saveInspection()">Save Draft</button>
                                <button class="btn btn-sm btn-outline-secondary" onclick="window.print()">Print Report</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Data & State
        const documents = [
            { id: 1, name: 'Bus. Permit' }, { id: 2, name: 'License to Operate' }, { id: 3, name: 'Mayor\'s Permit' },
            { id: 4, name: 'Brgy. Permit' }, { id: 5, name: 'FDA CPR of the Products' }, { id: 6, name: 'DTI-License' },
            { id: 7, name: 'Sanitary Permit' }, { id: 8, name: 'Fire Clearance' }, { id: 9, name: 'Environment Cert' },
            { id: 10, name: 'GMP/HACCP/ISO' }, { id: 11, name: 'Packaging Halal Cert' }, { id: 12, name: 'Warehouse Halal Cert' },
            { id: 13, name: 'Raw Mats Matrix' }, { id: 14, name: 'Raw Mats Halal Cert' }, { id: 15, name: 'Previous HDIP Cert' }
        ];

        let inspection = {
            documents: documents.map(d => ({ ...d, status: 'pending', remarks: '' }))
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderChecklist();
            updateSummary();
            setCurrentDate();
            
            // Check for saved draft
            const saved = localStorage.getItem('auditInspection');
            if(saved) {
                const data = JSON.parse(saved);
                document.getElementById('companyName').value = data.company || '';
                document.getElementById('contactPerson').value = data.contact || '';
                document.getElementById('address').value = data.address || '';
                document.getElementById('contactNo').value = data.contactNo || '';
                document.getElementById('auditorName').value = data.auditor || '';
                document.getElementById('auditorNotes').value = data.notes || '';
                if(data.documents) {
                    inspection.documents = data.documents;
                    renderChecklist();
                    updateSummary();
                }
            }
        });

        // Navigation
        function navigateToPage(page) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(`${page}-page`).classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${page}`).classList.add('active');
            window.scrollTo(0,0);
        }

        // Checklist Logic
        function renderChecklist() {
            const tbody = document.getElementById('checklistBody');
            tbody.innerHTML = inspection.documents.map(doc => {
                const isApproved = doc.status === 'approved' ? 'active' : '';
                const isRejected = doc.status === 'rejected' ? 'active' : '';
                const isPending = doc.status === 'pending' ? 'active' : '';
                
                return `
                <tr>
                    <td class="ps-4 fw-bold text-muted">${doc.id}</td>
                    <td class="fw-medium">${doc.name}</td>
                    <td>
                        <div class="btn-group btn-group-sm w-100" role="group">
                            <button type="button" class="btn btn-outline-success ${isApproved}" onclick="updateStatus(${doc.id}, 'approved')" title="Compliant"><i class="bi bi-check-lg"></i></button>
                            <button type="button" class="btn btn-outline-warning ${isPending}" onclick="updateStatus(${doc.id}, 'pending')" title="Pending"><i class="bi bi-hourglass"></i></button>
                            <button type="button" class="btn btn-outline-danger ${isRejected}" onclick="updateStatus(${doc.id}, 'rejected')" title="Non-Compliant"><i class="bi bi-x-lg"></i></button>
                        </div>
                    </td>
                    <td class="pe-4">
                        <input type="text" class="form-control form-control-sm table-input" 
                            placeholder="Remarks..." value="${doc.remarks}" 
                            onchange="updateRemarks(${doc.id}, this.value)">
                    </td>
                </tr>`;
            }).join('');
        }

        function updateStatus(id, status) {
            const doc = inspection.documents.find(d => d.id === id);
            if(doc) {
                doc.status = status;
                renderChecklist();
                updateSummary();
            }
        }

        function updateRemarks(id, val) {
            const doc = inspection.documents.find(d => d.id === id);
            if(doc) doc.remarks = val;
        }

        function updateSummary() {
            const total = inspection.documents.length;
            const conforms = inspection.documents.filter(d => d.status === 'approved').length;
            const nonconforms = inspection.documents.filter(d => d.status === 'rejected').length;
            
            document.getElementById('totalCount').innerText = `${conforms + nonconforms}/${total}`;
            document.getElementById('conformCount').innerText = conforms;
            document.getElementById('nonconformCount').innerText = nonconforms;
        }

        // Actions
        function markAllConforms() {
            inspection.documents.forEach(d => d.status = 'approved');
            renderChecklist();
            updateSummary();
        }

        function clearAllStatus() {
            if(confirm('Reset all statuses?')) {
                inspection.documents.forEach(d => { d.status = 'pending'; d.remarks = ''; });
                renderChecklist();
                updateSummary();
            }
        }

        function submitInspection() {
            const company = document.getElementById('companyName').value;
            const auditor = document.getElementById('auditorName').value;
            
            if(!company || !auditor) {
                alert("Please fill in Company Name and Certifier Name.");
                return;
            }

            const pending = inspection.documents.filter(d => d.status === 'pending').length;
            if(pending > 0 && !confirm(`There are ${pending} pending documents. Submit anyway?`)) return;

            alert("Inspection Review Submitted Successfully!");
            // In real app, post data here.
            navigateToPage('home');
        }

        function saveInspection() {
            const data = {
                company: document.getElementById('companyName').value,
                contact: document.getElementById('contactPerson').value,
                address: document.getElementById('address').value,
                contactNo: document.getElementById('contactNo').value,
                auditor: document.getElementById('auditorName').value,
                notes: document.getElementById('auditorNotes').value,
                documents: inspection.documents
            };
            localStorage.setItem('auditInspection', JSON.stringify(data));
            alert("Draft saved!");
        }

        function setCurrentDate() {
            document.getElementById('auditDate').value = new Date().toISOString().split('T')[0];
        }

        function loadCompanyData(id) {
            let data = {};
            if(id === 'mrfood') {
                data = { company: "Mr. Food Station", contact: "Jessa Rauf", address: "Davao City", contactNo: "0917-123-4567", auditor: "Engr. Fatima" };
            } else if (id === 'armando') {
                data = { company: "Cafe De Armando", contact: "Malik Ahsan", address: "Tagum City", contactNo: "0918-987-6543", auditor: "Engr. Fatima" };
            }
            
            document.getElementById('companyName').value = data.company;
            document.getElementById('contactPerson').value = data.contact;
            document.getElementById('address').value = data.address;
            document.getElementById('contactNo').value = data.contactNo;
            document.getElementById('auditorName').value = data.auditor;
            navigateToPage('inspection');
        }
    </script>
</body>
</html>